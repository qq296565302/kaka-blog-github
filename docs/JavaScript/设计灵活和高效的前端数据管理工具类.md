### è®¾è®¡çµæ´»å’Œé«˜æ•ˆçš„å‰ç«¯æ•°æ®ç®¡ç†å·¥å…·ç±»

åœ¨å¼€å‘ B ç«¯ç®¡ç†ç³»ç»Ÿé¡¹ç›®æ—¶ï¼Œé¢å¯¹ä¼—å¤šé¡µé¢çš„è¡¨æ ¼æ•°æ®æ“ä½œå’Œè¡¨å•å¢žåˆ æ”¹æŸ¥åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–ä»¥ä¸‹ç­–ç•¥æ¥è®¾è®¡ä¸€ä¸ªç»Ÿä¸€çš„æ•°æ®ç®¡ç†å·¥å…·ç±»ï¼Œä»¥æå‡é¡¹ç›®çš„çµæ´»æ€§å’Œæ•ˆçŽ‡ï¼š

-   æŠ½è±¡é€šç”¨æ“ä½œï¼šè¯†åˆ«æ‰€æœ‰é¡µé¢å…±æœ‰çš„æ•°æ®æ“ä½œæ¨¡å¼ï¼Œå¦‚**æ•°æ®èŽ·å–ã€åˆ›å»ºã€æ›´æ–°å’Œåˆ é™¤**ï¼Œå¹¶å°†è¿™äº›æ“ä½œæŠ½è±¡æˆé€šç”¨çš„æ–¹æ³•ã€‚
-   åˆ›å»ºå·¥å…·ç±»ï¼šå¼€å‘ä¸€ä¸ªå·¥å…·ç±»ï¼Œå°†è¿™äº›é€šç”¨æ–¹æ³•å°è£…èµ·æ¥ï¼Œ**å‡å°‘ä»£ç é‡å¤ï¼Œæé«˜ä»£ç å¤ç”¨æ€§**ã€‚
-   å‚æ•°åŒ–æ–¹æ³•ï¼šä½¿å·¥å…·ç±»ä¸­çš„æ–¹æ³•æŽ¥å—å‚æ•°ï¼Œä»¥é€‚åº”ä¸åŒé¡µé¢çš„å…·ä½“éœ€æ±‚ï¼Œ**å¢žåŠ æ–¹æ³•çš„é€šç”¨æ€§å’Œçµæ´»æ€§**ã€‚
-   é…ç½®åŒ–æŽ¥å£ï¼šé€šè¿‡**é…ç½®åŒ–çš„æ–¹å¼ç®¡ç†ä¸åŒé¡µé¢çš„æŽ¥å£åœ°å€å’Œå‚æ•°**ï¼Œä¾¿äºŽç»Ÿä¸€ç®¡ç†å’Œè°ƒæ•´ã€‚
-   ðŸš© **TODO** é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•ï¼šåœ¨å·¥å…·ç±»ä¸­é›†æˆé”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•æœºåˆ¶ï¼Œä¾¿äºŽé—®é¢˜è¿½è¸ªå’Œç³»ç»Ÿç»´æŠ¤ã€‚
-   å¼‚æ­¥å¤„ç†å’ŒçŠ¶æ€ç®¡ç†ï¼šç¡®ä¿å·¥å…·ç±»æ”¯æŒå¼‚æ­¥æ“ä½œï¼Œå¹¶åˆç†ç®¡ç†æ“ä½œçŠ¶æ€ï¼Œæå‡ç”¨æˆ·ä½“éªŒå’Œç³»ç»Ÿå“åº”æ€§ã€‚
-   ðŸš© **TODO** å®‰å…¨æ€§è€ƒè™‘ï¼šåœ¨å·¥å…·ç±»ä¸­åŠ å…¥å®‰å…¨æ£€æŸ¥ï¼Œå¦‚æƒé™éªŒè¯å’Œæ•°æ®åˆæ³•æ€§æ ¡éªŒï¼Œä¿éšœæ•°æ®å®‰å…¨ã€‚
-   ðŸš© **TODO** æ‰©å±•æ€§è®¾è®¡ï¼šè®¾è®¡æ—¶è€ƒè™‘æœªæ¥å¯èƒ½çš„åŠŸèƒ½æ‰©å±•ï¼Œä½¿å·¥å…·ç±»æ˜“äºŽæ·»åŠ æ–°ç‰¹æ€§æˆ–ä¿®æ”¹çŽ°æœ‰é€»è¾‘ã€‚

#### ä¸€ã€å®žçŽ°æ€è·¯

-   åˆ›å»ºä¸€ä¸ªæœåŠ¡ç±»æˆ–å·¥å…·ç±»ï¼šå°è£…æ‰€æœ‰çš„å¢žåˆ æ”¹æŸ¥æ–¹æ³•ã€‚
-   ä½¿ç”¨ `Map` å¯¹è±¡ï¼šå°†ä¸åŒé¡µé¢çš„æŽ¥å£å’Œæ–¹æ³•å­˜å‚¨åœ¨ `Map` ä¸­ã€‚
-   é€šç”¨æ–¹æ³•ï¼šæ ¹æ®é¡µé¢ä¼ å…¥çš„å‚æ•°ä»Ž `Map` ä¸­èŽ·å–å¯¹åº”çš„æŽ¥å£å’Œæ–¹æ³•ï¼Œç„¶åŽæ‰§è¡Œæ“ä½œã€‚

```JavaScript
/**
 * ApiService ç±»ç”¨äºŽç»Ÿä¸€ç®¡ç†å’Œè°ƒç”¨ä¸åŒé¡µé¢çš„APIæŽ¥å£ï¼ŒåŒ…æ‹¬æ•°æ®çš„å¢žåˆ æ”¹æŸ¥ç­‰æ“ä½œ
 */
class ApiService {
	constructor() {
		// å­˜å‚¨é¡µé¢æ ‡è¯†ä¸ŽæŽ¥å£é…ç½®çš„æ˜ å°„
		this.apiMap = new Map();
		// å­˜å‚¨æŽ¥å£è¯·æ±‚çš„ç¼“å­˜
		this.cache = new Map();
	}

	/**
	 * æ³¨å†ŒAPIï¼Œå°†é¡µé¢æ ‡è¯†å’Œå¯¹åº”çš„æŽ¥å£é…ç½®è¿›è¡Œå…³è”
	 * @param {string} pageName é¡µé¢æ ‡è¯†
	 * @param {Object} apiConfig æŽ¥å£é…ç½®å¯¹è±¡ï¼ŒåŒ…å«fetchã€createã€updateã€deleteå’Œexportç­‰æ–¹æ³•
	 */
	registerApi(pageName, apiConfig) {
		this.apiMap.set(pageName, apiConfig);
	}

	/**
	 * åŒ…è£…è¯·æ±‚æ–¹æ³•ï¼Œç”¨äºŽç»Ÿä¸€å¤„ç†APIè¯·æ±‚ä¸­çš„é”™è¯¯
	 * @param {Function} requestFunction è¯·æ±‚æ–¹æ³•å‡½æ•°
	 * @param {...*} args è¯·æ±‚æ–¹æ³•çš„å‚æ•°
	 * @returns {Promise} åŒ…å«è¯·æ±‚ç»“æžœçš„Promiseå¯¹è±¡
	 */
	async requestWithErrorHandling(requestFunction, ...args) {
		try {
			return await requestFunction(...args);
		} catch (error) {
			console.error("API Request failed:", error);
			throw new Error("Failed to perform the API request");
		}
	}

	/**
	 * æ ¹æ®é¡µé¢æ ‡è¯†å’Œå‚æ•°èŽ·å–è¡¨æ ¼æ•°æ®ï¼Œæ”¯æŒç¼“å­˜æœºåˆ¶
	 * @param {string} pageName é¡µé¢æ ‡è¯†
	 * @param {Object} params è¯·æ±‚å‚æ•°
	 * @param {boolean} useCache æ˜¯å¦ä½¿ç”¨ç¼“å­˜
	 * @returns {Promise} åŒ…å«è¯·æ±‚ç»“æžœçš„Promiseå¯¹è±¡
	 */
	async fetchData(pageName, params, useCache = false) {
		const cacheKey = `${pageName}_${JSON.stringify(params)}`;
		if (useCache && this.cache.has(cacheKey)) {
			return this.cache.get(cacheKey);
		}
		const apiConfig = this.apiMap.get(pageName);
		const data = await this.requestWithErrorHandling(apiConfig.fetch, params);
		this.cache.set(cacheKey, data);
		return data;
	}

	/**
	 * åœ¨æŒ‡å®šé¡µé¢æ–°å¢žæ•°æ®
	 * @param {string} pageName é¡µé¢æ ‡è¯†
	 * @param {Object} data æ–°å¢žçš„æ•°æ®
	 * @returns {Promise} åŒ…å«è¯·æ±‚ç»“æžœçš„Promiseå¯¹è±¡
	 */
	async createData(pageName, data) {
		const apiConfig = this.apiMap.get(pageName);
		return this.requestWithErrorHandling(apiConfig.create, data);
	}

	/**
	 * æ›´æ–°æŒ‡å®šé¡µé¢çš„æŸä¸ªæ•°æ®
	 * @param {string} pageName é¡µé¢æ ‡è¯†
	 * @param {string|number} id æ•°æ®çš„å”¯ä¸€æ ‡è¯†
	 * @param {Object} data æ›´æ–°çš„æ•°æ®
	 * @returns {Promise} åŒ…å«è¯·æ±‚ç»“æžœçš„Promiseå¯¹è±¡
	 */
	async updateData(pageName, id, data) {
		const apiConfig = this.apiMap.get(pageName);
		return this.requestWithErrorHandling(apiConfig.update, id, data);
	}

	/**
	 * åˆ é™¤æŒ‡å®šé¡µé¢çš„æŸä¸ªæ•°æ®
	 * @param {string} pageName é¡µé¢æ ‡è¯†
	 * @param {string|number} id æ•°æ®çš„å”¯ä¸€æ ‡è¯†
	 * @returns {Promise} åŒ…å«è¯·æ±‚ç»“æžœçš„Promiseå¯¹è±¡
	 */
	async deleteData(pageName, id) {
		const apiConfig = this.apiMap.get(pageName);
		return this.requestWithErrorHandling(apiConfig.delete, id);
	}

	/**
	 * å¯¼å‡ºæŒ‡å®šé¡µé¢çš„æ•°æ®
	 * @param {string} pageName é¡µé¢æ ‡è¯†
	 * @param {Object} params å¯¼å‡ºå‚æ•°
	 * @returns {Promise} åŒ…å«è¯·æ±‚ç»“æžœçš„Promiseå¯¹è±¡
	 */
	async exportData(pageName, params) {
		const apiConfig = this.apiMap.get(pageName);
		return this.requestWithErrorHandling(apiConfig.export, params);
	}
}

// å¯¼å‡ºApiServiceç±»çš„å®žä¾‹ä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨
export default new ApiService();
```

#### äºŒã€æ³¨å†ŒæŽ¥å£

åœ¨éœ€è¦çš„é¡µé¢æˆ–æ¨¡å—ä¸­æ³¨å†ŒæŽ¥å£ï¼š

```JavaScript
// ä»¥é¡¹ç›®ä¸­çš„.vueæ–‡ä»¶ä¸ºä¾‹ï¼ˆvue3.xï¼‰

import apiService from '@/utils/ApiService'
import request from "@/utils/request";
import exportFile from "@/utils/exportFile";

// åœ¨é¡¹ç›®å¯åŠ¨æ—¶æˆ–åœ¨é¡µé¢åˆå§‹åŒ–æ—¶æ³¨å†ŒæŽ¥å£
apiService.registerApi('userManagement', {
	fetch: (params) => axios.get('/api/users', { params }),
  create: (data) => axios.post('/api/users', data),
  update: (id, data) => axios.put(`/api/users/${id}`, data),
  delete: (id) => axios.delete(`/api/users/${id}`),
	export: (params) => exportFile('/api/users/export', params), // å¯¼å‡ºæ–‡ä»¶
});

```

#### ä¸‰ã€åœ¨é¡µé¢ä¸­è°ƒç”¨

åœ¨å„ä¸ªé¡µé¢ä¸­ï¼Œåªéœ€è¦è°ƒç”¨ `ApiService` çš„é€šç”¨æ–¹æ³•ï¼Œä¼ å…¥å¯¹åº”çš„é¡µé¢æ ‡è¯†ç¬¦å³å¯ï¼šï¼ˆè¿™é‡ŒæŽ¨èå’Œä¸Šé¢æ³¨å†ŒæŽ¥å£æ”¾åœ¨åŒä¸€ä¸ª`.vue`æ–‡ä»¶å†…ï¼Œæ–¹ä¾¿ç®¡ç†ï¼‰

```JavaScript
// vue3.x
const loadUsers = async()=>{
  const result = await apiService.fetchData('userManagement', { page: 1, size: 10 });
}

const createUser = async (user) => {
  await apiService.createData('userManagement', user);
},

const updateUser = async (id, user) => {
  await apiService.updateData('userManagement', id, user);
},

const deleteUser = async (id) => {
  await apiService.deleteData('userManagement', id);
}
```
